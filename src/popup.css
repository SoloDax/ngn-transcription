:root {
  --bg:#1a1a2e;--bg2:#16213e;--bg3:#1e2a47;--tx:#e4e4e7;--tx2:#a1a1aa;--txm:#71717a;
  --bd:#2a2a4a;--pr:#6366f1;--prh:#5558e6;--prl:rgba(99,102,241,.15);
  --dg:#ef4444;--dgl:rgba(239,68,68,.15);--ok:#10b981;--okl:rgba(16,185,129,.15);
  --sh:0 1px 3px rgba(0,0,0,.3);--shl:0 4px 12px rgba(0,0,0,.4);--r:10px;--rs:6px;
}
*{margin:0;padding:0;box-sizing:border-box}
body{width:400px;height:520px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Inter',sans-serif;font-size:13px;color:var(--tx);background:var(--bg);overflow:hidden;display:flex;flex-direction:column}
a{color:var(--pr);text-decoration:none}a:hover{text-decoration:underline}

/* ── Onboarding ── */
.onboarding{padding:0;overflow-y:auto;max-height:520px}
.onboard-hero{text-align:center;padding:28px 20px 16px;background:linear-gradient(135deg,var(--pr),#8b5cf6);color:#fff;border-radius:0 0 16px 16px}
.onboard-icon{display:inline-flex;align-items:center;justify-content:center;width:56px;height:56px;border-radius:16px;background:rgba(255,255,255,.2);margin-bottom:12px}
.onboard-hero h2{font-size:18px;font-weight:700;margin-bottom:4px}
.onboard-hero p{font-size:12px;opacity:.85}
.onboard-steps{padding:14px 16px}
.onboard-step{display:flex;gap:12px;padding:10px 0;border-bottom:1px solid var(--bd)}
.onboard-step:last-child{border-bottom:none}
.step-num{display:flex;align-items:center;justify-content:center;min-width:26px;height:26px;border-radius:50%;background:var(--prl);color:var(--pr);font-weight:700;font-size:12px}
.onboard-step strong{display:block;font-size:13px;margin-bottom:2px}
.onboard-step p{font-size:11px;color:var(--tx2);margin-bottom:6px}
.onboard-step .setting-input{font-size:12px;padding:7px 10px}

/* ── Header ── */
.header{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-bottom:1px solid var(--bd);background:var(--bg2);min-height:48px}
.header-left{display:flex;align-items:center;gap:8px}
.logo{display:flex;align-items:center;justify-content:center;width:30px;height:30px;border-radius:8px;background:var(--pr);color:#fff}
.header-title{font-size:15px;font-weight:700;letter-spacing:-.3px}
.header-center{flex:1;display:flex;justify-content:center}
.rec-btn{all:unset;display:flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:50%;background:var(--pr);color:#fff;cursor:pointer;transition:all .2s;box-shadow:var(--sh)}
.rec-btn:hover{background:var(--prh);transform:scale(1.08)}
.rec-btn.recording{background:var(--dg);animation:rec-pulse 2s ease-in-out infinite}
@keyframes rec-pulse{0%,100%{box-shadow:0 0 0 0 rgba(239,68,68,.4)}50%{box-shadow:0 0 0 8px rgba(239,68,68,0)}}
.timer{display:flex;align-items:center;gap:6px;font-size:12px;font-weight:600;color:var(--tx2);font-variant-numeric:tabular-nums}
.timer-dot{width:6px;height:6px;border-radius:50%;background:var(--dg);animation:tdot 1.5s ease-in-out infinite}
@keyframes tdot{0%,100%{opacity:1}50%{opacity:.3}}
.timer-cost{font-size:10px;color:var(--txm);font-weight:400}

/* ── Tab Bar ── */
.tab-bar{display:flex;border-bottom:1px solid var(--bd);background:var(--bg2);padding:0 8px}
.tab{all:unset;flex:1;padding:9px 0;font-size:12px;font-weight:500;text-align:center;color:var(--txm);cursor:pointer;border-bottom:2px solid transparent;transition:all .15s}
.tab:hover{color:var(--tx2)}
.tab.active{color:var(--pr);border-bottom-color:var(--pr);font-weight:600}

/* ── Tab Content ── */
.tab-content{display:none;flex:1;flex-direction:column;overflow:hidden}
.tab-content.active{display:flex}

/* ── Transcript Tab ── */
.status-bar{display:flex;align-items:center;justify-content:space-between;padding:8px 14px;border-bottom:1px solid var(--bd)}
.status-indicator{display:flex;align-items:center;gap:6px;font-size:11px;font-weight:500;color:var(--tx2)}
.status-dot{width:7px;height:7px;border-radius:50%;background:var(--txm);transition:background .3s}
.status-indicator.recording .status-dot{background:var(--dg);animation:pdot 1.5s ease-in-out infinite}
.status-indicator.connected .status-dot{background:var(--ok)}
.status-indicator.error .status-dot{background:var(--dg)}
@keyframes pdot{0%,100%{opacity:1}50%{opacity:.5}}
.char-count{font-size:10px;color:var(--txm);font-variant-numeric:tabular-nums}
.transcript-area{flex:1;overflow-y:auto;padding:14px;scroll-behavior:smooth}
.transcript-empty{height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;color:var(--txm)}
.empty-title{font-size:13px;font-weight:600;color:var(--tx2)}
.empty-sub{font-size:11px}
.transcript-content{display:none;font-size:14px;line-height:1.7;word-break:break-word;direction:auto;unicode-bidi:plaintext}
.transcript-content.active{display:block}
.transcript-content .final{color:var(--tx)}
.transcript-content .partial{color:var(--txm)}
.transcript-content .cursor{display:inline-block;width:2px;height:16px;background:var(--pr);margin-left:2px;vertical-align:middle;animation:blink 1s step-end infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}
.transcript-actions{display:flex;gap:6px;padding:8px 14px;border-top:1px solid var(--bd)}
.btn-sm{all:unset;display:flex;align-items:center;gap:5px;padding:5px 10px;font-size:11px;font-weight:500;color:var(--tx2);border:1px solid var(--bd);border-radius:var(--rs);cursor:pointer;transition:all .15s}
.btn-sm:hover{background:var(--bg3);color:var(--tx)}
.btn-sm.active{background:var(--prl);color:var(--pr);border-color:var(--pr)}

/* ── Settings Scroll ── */
.settings-scroll{flex:1;overflow-y:auto;padding:14px;display:flex;flex-direction:column;gap:14px}
.setting-group{display:flex;flex-direction:column;gap:5px}
.setting-label{font-size:11px;font-weight:600;color:var(--tx2);text-transform:uppercase;letter-spacing:.4px}
.setting-input{width:100%;padding:8px 11px;border:1px solid var(--bd);border-radius:var(--rs);background:var(--bg);color:var(--tx);font-size:12px;outline:none;transition:border-color .15s}
.setting-input:focus{border-color:var(--pr);box-shadow:0 0 0 3px var(--prl)}
select.setting-input{cursor:pointer;-webkit-appearance:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 10px center;padding-right:28px}
textarea.setting-input{resize:vertical;min-height:36px;font-family:inherit}
.setting-hint{font-size:10px;color:var(--txm)}
.input-with-action{display:flex;gap:4px}
.input-with-action .setting-input{flex:1}
.btn-icon{all:unset;display:flex;align-items:center;justify-content:center;width:34px;border:1px solid var(--bd);border-radius:var(--rs);color:var(--tx2);cursor:pointer;transition:all .12s}
.btn-icon:hover{background:var(--bg3);color:var(--tx)}

/* Collapsible */
.collapsible{border:1px solid var(--bd);border-radius:8px;padding:8px 12px}
.collapsible[open]{padding-bottom:10px}
.collapsible summary{font-size:12px;font-weight:500;color:var(--tx2);cursor:pointer;list-style:none}
.collapsible summary::-webkit-details-marker{display:none}
.collapsible summary::before{content:'▸ '}
.collapsible[open] summary::before{content:'▾ '}
.details-body{margin-top:8px}
.preset-chips{display:flex;flex-wrap:wrap;gap:5px;margin-bottom:6px}
.chip{all:unset;padding:4px 9px;border-radius:14px;font-size:11px;background:var(--bg2);color:var(--tx2);border:1px solid var(--bd);cursor:pointer;transition:all .12s;white-space:nowrap}
.chip:hover{border-color:var(--pr);color:var(--tx)}
.chip.active{background:var(--prl);border-color:var(--pr);color:var(--pr);font-weight:500}

/* Buttons */
.setting-row{display:flex;gap:8px}
.setting-row>*{flex:1}
.btn-primary{all:unset;display:flex;align-items:center;justify-content:center;gap:6px;padding:9px;border-radius:var(--rs);font-size:12px;font-weight:600;cursor:pointer;transition:all .15s;background:var(--pr);color:#fff;text-align:center}
.btn-primary:hover{background:var(--prh)}
.btn-outline{all:unset;display:flex;align-items:center;justify-content:center;gap:6px;padding:9px;border-radius:var(--rs);font-size:12px;font-weight:500;cursor:pointer;transition:all .15s;border:1px solid var(--bd);color:var(--tx2);text-align:center}
.btn-outline:hover{background:var(--bg3);border-color:var(--txm)}
.test-result{font-size:11px;padding:7px 10px;border-radius:var(--rs);display:none}
.test-result.success{display:block;background:var(--okl);color:var(--ok)}
.test-result.error{display:block;background:var(--dgl);color:var(--dg)}

/* ── Captions Tab ── */
.range-row{display:flex;align-items:center;gap:10px}
.setting-range{-webkit-appearance:none;flex:1;height:4px;border-radius:2px;background:var(--bd);outline:none}
.setting-range::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;border-radius:50%;background:var(--pr);cursor:pointer}
.range-value{font-size:11px;color:var(--txm);font-variant-numeric:tabular-nums;min-width:32px;text-align:right}
.radio-group{display:flex;gap:6px}
.radio-option{display:flex;align-items:center;gap:5px;padding:6px 12px;border:1px solid var(--bd);border-radius:var(--rs);font-size:12px;color:var(--tx2);cursor:pointer;transition:all .12s}
.radio-option:has(input:checked){background:var(--prl);border-color:var(--pr);color:var(--pr)}
.radio-option input{display:none}
.color-row{display:flex;align-items:center;gap:10px}
.color-input{-webkit-appearance:none;width:32px;height:32px;border:2px solid var(--bd);border-radius:var(--rs);background:none;cursor:pointer;padding:0}
.color-input::-webkit-color-swatch-wrapper{padding:2px}
.color-input::-webkit-color-swatch{border:none;border-radius:3px}
.color-label{font-size:12px;color:var(--txm);font-family:monospace}
.toggles-row{display:flex;gap:8px}
.toggle-label{display:flex;align-items:center;gap:5px;padding:6px 12px;border:1px solid var(--bd);border-radius:var(--rs);font-size:12px;color:var(--tx2);cursor:pointer;transition:all .12s;flex:1;justify-content:center}
.toggle-label:has(input:checked){background:var(--prl);border-color:var(--pr);color:var(--pr)}
.toggle-label input{display:none}

/* ── Export Tab ── */
.export-info{display:flex;gap:8px;margin-bottom:6px}
.export-stat{flex:1;text-align:center;padding:12px 8px;background:var(--bg2);border-radius:8px;border:1px solid var(--bd)}
.stat-label{display:block;font-size:10px;color:var(--txm);text-transform:uppercase;letter-spacing:.3px;margin-bottom:4px}
.stat-value{display:block;font-size:15px;font-weight:700;color:var(--tx);font-variant-numeric:tabular-nums}
.export-buttons{display:flex;flex-direction:column;gap:8px}
.btn-export{all:unset;display:flex;align-items:center;gap:12px;padding:12px 14px;border:1px solid var(--bd);border-radius:8px;cursor:pointer;transition:all .15s;color:var(--tx2)}
.btn-export:hover{background:var(--bg3);border-color:var(--txm);color:var(--tx)}
.btn-export svg{flex-shrink:0;color:var(--pr)}
.btn-export strong{display:block;font-size:13px;color:var(--tx)}
.btn-export small{font-size:11px;color:var(--txm)}

/* ── Balance Calculator ── */
.balance-card{background:var(--bg2);border:1px solid var(--bd);border-radius:10px;padding:12px;display:flex;flex-direction:column;gap:10px}
.balance-header{display:flex;justify-content:space-between;align-items:center;font-size:12px;font-weight:600;color:var(--tx2)}
.balance-link{font-size:10px;font-weight:400;color:var(--pr);text-decoration:none}
.balance-link:hover{text-decoration:underline}
.balance-input-row{display:flex;align-items:center;gap:6px}
.balance-label{font-size:14px;font-weight:700;color:var(--pr)}
.balance-input{flex:1;padding:8px 10px;border:1px solid var(--bd);border-radius:var(--rs);background:var(--bg);color:var(--tx);font-size:13px;outline:none}
.balance-input:focus{border-color:var(--pr);box-shadow:0 0 0 3px var(--prl)}
.balance-input::placeholder{color:var(--txm)}
.balance-result{display:flex;flex-direction:column;gap:8px}
.balance-remaining{display:flex;align-items:center;gap:10px;color:var(--tx)}
.balance-remaining svg{color:var(--ok);flex-shrink:0}
.balance-time{display:block;font-size:18px;font-weight:700;color:var(--ok)}
.balance-sub{display:block;font-size:10px;color:var(--txm)}
.balance-bar-wrap{height:6px;background:var(--bd);border-radius:3px;overflow:hidden}
.balance-bar{height:100%;background:linear-gradient(90deg,var(--ok),var(--pr));border-radius:3px;transition:width .5s ease;width:100%}

/* ── Toast ── */
.toast{position:fixed;bottom:14px;left:50%;transform:translateX(-50%) translateY(80px);padding:8px 18px;border-radius:var(--r);background:var(--tx);color:var(--bg);font-size:12px;font-weight:500;box-shadow:var(--shl);transition:transform .3s;z-index:100;white-space:nowrap}
.toast.visible{transform:translateX(-50%) translateY(0)}

/* Scrollbar */
.settings-scroll::-webkit-scrollbar,.transcript-area::-webkit-scrollbar{width:3px}
.settings-scroll::-webkit-scrollbar-track,.transcript-area::-webkit-scrollbar-track{background:transparent}
.settings-scroll::-webkit-scrollbar-thumb,.transcript-area::-webkit-scrollbar-thumb{background:var(--bd);border-radius:2px}

#main-app{display:flex;flex-direction:column;height:100%}
